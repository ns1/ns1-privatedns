bootstrap: false
imagePullSecret: docker-cfg

data:
  name: data
  replicas: 3
  image:
    name: nsone/standalone_data
    tag: 97c87fa9f
    pullPolicy: IfNotPresent
  livenessProbe:
    initialDelaySeconds: 300
    failureThreshold: 3
    periodSeconds: 15
  storage:
    className: gp2 # block storage for Digital Ocean
    size: 2Gi
  popID: default_pop
  startupFlags: {}
  resources: {}
  tolerations: []
  # Makes sure that data pods are not scheduled on the same node.
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app
            operator: In
            values:
            - data
        topologyKey: "kubernetes.io/hostname"

core:
  name: core
  replicas: 2
  image:
    name: nsone/standalone_core
    tag: 97c87fa9f
    pullPolicy: IfNotPresent
  livenessProbe:
    initialDelaySeconds: 30
    failureThreshold: 3
    periodSeconds: 15
  storage:
    className: gp2 # block storage for Digital Ocean
    size: 2Gi
  popID: default_pop
  apiHostname: api.example.com
  portalHostname: portal.example.com
  nameServers: "example1.com,example2.com"
  hostMasterEmail: "example@email.com"
  enableOpsMetrics: false
  enableWebTLS: false
  startupFlags: {}
  resources: {}
  # Run the core pods on the main set of nodes.
  tolerations: []
  # Makes sure that core pods are not scheduled on the same node
  # and that they are co-located with a data pod.
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app
            operator: In
            values:
            - core
        topologyKey: "kubernetes.io/hostname"
    podAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app
            operator: In
            values:
            - data
        topologyKey: "kubernetes.io/hostname"

dns:
  image:
    name: nsone/standalone_dns
    tag: 97c87fa9f
    pullPolicy: IfNotPresent
  pops:
  - name: dns
    replicas: 3
    livenessProbe:
      initialDelaySeconds: 30
      failureThreshold: 3
      periodSeconds: 15
    popID: default_pop
    coreService: core
    operationMode: authoritative
    enableOpsMetrics: false
    startupFlags: {}
    resources: {}
    # Run these DNS replicas on the main set of nodes.
    tolerations: []
    affinity: {}
  - name: dns-edge
    replicas: 1
    livenessProbe:
      initialDelaySeconds: 30
      failureThreshold: 3
      periodSeconds: 15
    popID: edge_pop
    # Since this is an edge, the DNS pod should communicate with dist, not
    # core.
    coreService: dist
    operationMode: authoritative
    enableOpsMetrics: false
    startupFlags: {}
    resources: {}
    # Run this DNS replica on an edge node.
    # Toleration for the taint on the edge node.
    tolerations:
    - key: "location"
      operator: "Equal"
      value: "edge"
      effect: "NoSchedule"
    affinity: {}

dist:
  image:
    name: nsone/standalone_dist
    tag: 97c87fa9f
    pullPolicy: IfNotPresent
  pops:
  - name: dist
    replicas: 1
    livenessProbe:
      initialDelaySeconds: 30
      failureThreshold: 3
      periodSeconds: 15
    storage:
      className: gp2 # block storage for Digital Ocean
      size: 2Gi
    popID: edge_pop
    coreService: core
    enableOpsMetrics: false
    startupFlags: {}
    resources: {}
    # The dist pod is ran at the edge.
    tolerations:
    - key: "location"
      operator: "Equal"
      value: "edge"
      effect: "NoSchedule"
    affinity: {}

